# data_fetch_main.py
import os
import sys
from pathlib import Path
import asyncio

# Add project root to the Python path for module imports
script_dir = Path(__file__).resolve().parent
project_root = script_dir.parent.parent
sys.path.append(str(project_root))

from Scripts.Data_Fetchers.alpha_vantage_fetcher import AlphaVantageDataFetcher

async def main():
    fetcher = AlphaVantageDataFetcher()
    data = await fetcher.async_fetch_data("AAPL")
    if not data.empty and fetcher.validate_data(data):
        fetcher.save_data(data, "AAPL", processed=True, overwrite=True, versioning=True, archive=True)
    
    real_time_data = await fetcher.fetch_real_time_data("AAPL")
    if not real_time_data.empty and fetcher.validate_data(real_time_data):
        fetcher.save_data(real_time_data, "AAPL", processed=True, overwrite=True, versioning=True, archive=True)
    
    print("Data fetching completed.")

if __name__ == "__main__":
    asyncio.run(main())
